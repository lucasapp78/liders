
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>L.A Cashback VIP üëë</title>
<style>
body {
    background: linear-gradient(180deg, #0d0d0d, #1a1a1a);
    color: #f1f1f1;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    padding: 20px;
}
h2 {
    color: #ff7f00;
    text-align: center;
    margin-bottom: 20px;
}
label { color: #f1f1f1; margin-top: 5px; display: block; }
input, select {
    width: 100%;
    margin-bottom: 10px;
    padding: 8px;
    background-color: #121212;
    border: 1px solid #333;
    color: #fff;
    border-radius: 8px;
}
button {
    width: 100%;
    margin-bottom: 10px;
    background-color: #ff7f00;
    border: none;
    color: white;
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
}
button:hover {
    background-color: #e56700;
}
.jogo-card {
    background: linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.65)),
                url('https://i.imgur.com/ww9zFej.png');
    background-size: cover;
    background-position: center;
    border: 1px solid #333;
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.6);
}
.jogo-header {
    background-color: #ff7f00;
    color: white;
    padding: 8px 16px;
    border-radius: 10px;
    font-weight: bold;
    text-align: center;
    text-transform: uppercase;
}
.jogo-info {
    text-align: center;
    margin: 8px 0;
    color: #ccc;
}
.jogo-times {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 12px;
}
.jogo-times img {
    width: 50px;
    height: 50px;
}
.jogo-times strong {
    font-size: 1.1rem;
}
.mercado-principal {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 10px;
}

.mercado-principal label {
    flex: 1 1 calc(33.333% - 20px);
    max-width: calc(33.333% - 20px);
    text-align: center;
    background: #2c2c2c;
    padding: 8px 16px;
    border-radius: 10px;
    cursor: pointer;
    border: 1px solid #444;
    transition: all 0.2s;
    box-sizing: border-box;
}

@media (max-width: 480px) {
    .mercado-principal label {
        flex: 1 1 100%;
        max-width: 100%;
    }
}
.mercado-principal label:hover {
    background: #ff7f00;
    color: #121212;
}
.mais-odds {
    background: #181818;
    border-radius: 10px;
    padding: 10px;
    border: 1px solid #333;
}
.btn-mais-odds {
    background-color: #333;
    color: #fff;
    border: none;
    padding: 6px 12px;
    border-radius: 8px;
}
.btn-mais-odds:hover {
    background-color: #444;
}

@media (max-width: 768px) {
    body {
        padding: 10px;
        font-size: 14px;
    }
    h2 {
        font-size: 1.2rem;
    }
    .jogo-card {
        padding: 12px;
    }
    .jogo-times {
        flex-direction: column;
        gap: 10px;
    }
    .jogo-times img {
        width: 40px;
        height: 40px;
    }
    .mercado-principal label {
        flex: 1 1 100%;
        max-width: 100%;
    }
    .btn-mais-odds, .btn-toggle-mercado {
        width: 100%;
    }
    input, select, button {
        font-size: 1rem;
    }
}


/* Anima√ß√µes sofisticadas */

.jogo-card {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease forwards;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
}

@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.mercado-principal label:hover,
.btn-mais-odds:hover,
button:hover {
    background-color: #ff7f00;
    color: #121212;
    box-shadow: 0 0 10px #ff7f00, 0 0 20px #ff7f00;
    transition: all 0.3s ease;
}

button[onclick*="bgMusic"] {
    animation: pulse 1.8s infinite;
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(255, 127, 0, 0.7);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(255, 127, 0, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(255, 127, 0, 0);
    }
}

.jogo-times img {
    transition: transform 0.3s ease;
}

.jogo-times img:hover {
    transform: scale(1.2);
}


/* === Estilo Premium para Odds === */
input[type="checkbox"] {
    display: none;
}
.mercado-principal label,
.mais-odds label {
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #2c2c2c;
    border: 2px solid #444;
    border-radius: 12px;
    padding: 10px 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    box-shadow: 0 4px 10px rgba(0,0,0,0.4);
}
.mercado-principal label:hover,
.mais-odds label:hover {
    background-color: #ff7f00;
    color: #121212;
    box-shadow: 0 0 10px #ff7f00, 0 0 20px #ff7f00;
}
input[type="checkbox"]:checked + label {
    background-color: #ff7f00;
    color: #121212;
    border-color: #ff7f00;
    box-shadow: 0 0 10px #ff7f00, 0 0 20px #ff7f00;
}


.bilhete-lateral {
    position: fixed;
    top: 80px;
    right: 20px;
    width: 300px;
    background: #1a1a1a;
    border: 2px solid #ff7f00;
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.7);
    color: white;
    z-index: 999;
    max-height: 90vh;
    overflow-y: auto;
}
.bilhete-lateral h3 {
    margin-top: 0;
    color: #ff7f00;
    text-align: center;
}
#bilhete-selecoes {
    max-height: 150px;
    overflow-y: auto;
    margin-bottom: 10px;
}
#resultado-desdobramento {
    margin-top: 10px;
    background: #121212;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #333;
}
#botao-bilhete {
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #ff7f00;
    color: white;
    border: none;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    z-index: 1000;
}
@media (max-width: 768px) {
    .bilhete-lateral {
        display: none;
        width: 90%;
        left: 5%;
        right: 5%;
        top: 80px;
    }
    #botao-bilhete {
        display: block;
    }
}

</style>
</head>
<body>

<div id="bilhete" class="bilhete-lateral">
  <h3>üéØ Desdobramento</h3>
  <div id="bilhete-selecoes"></div>
  <label>Acertos desejados:</label>
  <select id="acertos-desejados"></select>
  <label>Valor por combina√ß√£o (R$):</label>
  <input type="number" id="valor-aposta" placeholder="10.00" step="0.01" oninput="atualizarRetorno()">
  <div id="resultado-desdobramento"></div>
  <button onclick="limparSelecoes()">üßπ Limpar</button>
  <button onclick="exportarPDF()">üìÑ PDF</button>
  <button onclick="compartilharWhatsApp()">üì§ WhatsApp</button>
</div>
<button id="botao-bilhete" onclick="toggleBilhete()">üéØ</button>


<audio id="bgMusic" loop>
  <source src="musica.mp3" type="audio/mpeg">
  Seu navegador n√£o suporta √°udio.
</audio>

<button onclick="document.getElementById('bgMusic').play()" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #ff7f00;
  color: white;
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 20px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  z-index: 999;
">üîä</button>


<h2>L.A Cashback VIP üëë</h2>

<label>Campeonato:</label>
<select id="liga">
  <option value="71">üáßüá∑ Brasileir√£o S√©rie A</option>
  <option value="72">üáßüá∑ Brasileir√£o S√©rie B</option>
  <option value="75">üáßüá∑ Brasileir√£o S√©rie C</option>
  <option value="76">üáßüá∑ Brasileir√£o S√©rie D</option>
  <option value="73">üáßüá∑ Copa do Brasil</option>
  <option value="11">üåé   Copa Sul-Americana </option>
  <option value="13">üåé Libertadores</option>
  <option value="2">üåç Champions League</option>
  <option value="3">üåç Europa League</option>
  <option value="848">üåç Conference League</option>
  <option value="39">üè¥ Premier League (Inglaterra)</option>
  <option value="140">üá™üá∏ La Liga (Espanha)</option>
  <option value="78">üáÆüáπ Serie A (It√°lia)</option>
  <option value="61">üá´üá∑ Ligue 1 (Fran√ßa)</option>
  <option value="195">üá©üá™ Bundesliga (Alemanha)</option>
  <option value="94">üáµüáπ Primeira Liga (Portugal)</option>
  <option value="88">üá≥üá± Eredivisie (Holanda)</option>
  <option value="253">üá∫üá∏ MLS (EUA)</option>
  <option value="34">Eliminat√≥rias da CONMEBOL</option>
</select>


<label>Filtrar por Time:</label>
<input type="text" id="filtroTime" placeholder="Ex: Flamengo, Chelsea, Real Madrid">
<label>Filtrar por Data:</label>
<input type="date" id="dataFiltro">

<label>Odd M√≠nima:</label>
<input type="number" id="oddMin" placeholder="Ex: 1.50" step="0.01">

<label>Odd M√°xima:</label>
<input type="number" id="oddMax" placeholder="Ex: 3.00" step="0.01">


<button onclick="carregarOddsReais()">üîÑ Carregar Jogos do Dia</button>
<button onclick="carregarJogosAoVivo(); iniciarAutoAtualizacaoAoVivo();">üì∫ Jogos Ao Vivo</button>

<label>Tipo de aposta (acertos):</label>
<select id="tipoDesdobramento">
<option value="1">Acertar 1</option>
<option value="2">Acertar 2</option>
<option value="3">Acertar 3</option>
<option value="4">Acertar 4</option>
<option value="5">Acertar 5</option>
<option value="6">Acertar 6</option>
<option value="7">Acertar 7</option>
<option value="8">Acertar 8</option>
<option value="9">Acertar 9</option>
<option value="10">Acertar 10</option>
</select>

<input type="number" id="stake" placeholder="Valor por combina√ß√£o (R$)" step="0.01" value="10">

<button onclick="gerarDesdobramento()">‚öôÔ∏è Gerar Bilhetes</button>
<button onclick="exportarPDF()">üìÑ Exportar PDF</button>
<button onclick="compartilharWhatsApp()">üì§ Compartilhar no WhatsApp</button>

<div id="resultado"></div>
<div id="inputs"></div>

<script>
const API_KEY = "69b92fb729838ba69139a6d92c457f83";

function traduzirValorOdd(valor) {
    if (typeof valor !== 'string') valor = String(valor);
    return valor
        .replace(/\bHome\b/g, 'Casa')
        .replace(/\bAway\b/g, 'Fora')
        .replace(/\bDraw\b/g, 'Empate')
        .replace(/\bYes\b/g, 'Sim')
        .replace(/\bNo\b/g, 'N√£o')
        .replace(/\bOver\b/g, 'Acima')
        .replace(/\bUnder\b/g, 'Abaixo');
}

function traduzirMercado(nomeOriginal) {
    const traducoes = {
        
   
  "Home/Away": "Casa/Fora",
  "Second Half Winner": "Vencedor do Segundo Tempo",
  "Asian Handicap": "Handicap Asi√°tico",
  "Goals Over/Under": "Gols Acima/Abaixo",
  "Goals Over/Under First Half": "Gols Acima/Abaixo - 1¬∫ Tempo",
  "Goals Over/Under - Second Half": "Gols Acima/Abaixo - 2¬∫ Tempo",
  "HT/FT Double": "Dupla HT/FT",
  "Both Teams Score": "Ambos Marcam",
  "Exact Score": "Placar Exato",
  "Highest Scoring Half": "Tempo com Mais Gols",
  "Correct Score - First Half": "Placar Exato - 1¬∫ Tempo",
  "Double Chance": "Dupla Possibilidade",
  "First Half Winner": "Vencedor do 1¬∫ Tempo",
  "Total - Home": "Total - Time da Casa",
  "Total - Away": "Total - Time Visitante",
  "Asian Handicap First Half": "Handicap Asi√°tico - 1¬∫ Tempo",
  "Double Chance - First Half": "Dupla Possibilidade - 1¬∫ Tempo",
  "Double Chance - Second Half": "Dupla Possibilidade - 2¬∫ Tempo",
  "Both Teams Score - First Half": "Ambos Marcam - 1¬∫ Tempo",
  "Both Teams To Score - Second Half": "Ambos Marcam - 2¬∫ Tempo",
  "Odd/Even": "√çmpar/Par",
  "Home win both halves": "Time da Casa Vence Ambos os Tempos",
  "Away win both halves": "Time Visitante Vence Ambos os Tempos",
  "Exact Goals Number": "N√∫mero Exato de Gols",
  "To Win Either Half": "Vencer Qualquer Tempo",
  "Home Team Exact Goals Number": "N√∫mero Exato de Gols - Time da Casa",
  "Away Team Exact Goals Number": "N√∫mero Exato de Gols - Time Visitante",
  "Results/Both Teams Score": "Resultado/Ambos Marcam",
  "First 10 min Winner": "Vencedor nos Primeiros 10 Minutos",
  "Corners Over Under": "Escanteios Acima/Abaixo",
  "Exact Goals Number - First Half": "N√∫mero Exato de Gols - 1¬∫ Tempo",
  "Home Team Total Goals(1st Half)": "Total de Gols - Time da Casa (1¬∫ Tempo)",
  "Away Team Total Goals(1st Half)": "Total de Gols - Time Visitante (1¬∫ Tempo)",
  "1x2 - 60 minutes": "1x2 - 60 minutos",
  "1x2 - 30 minutes": "1x2 - 30 minutos",
  "Total Corners (1st Half)": "Total de Escanteios (1¬∫ Tempo)",
  "Cards Over/Under": "Cart√µes Acima/Abaixo",
  "Cards Asian Handicap": "Handicap Asi√°tico de Cart√µes",
  "Home Team Total Cards": "Total de Cart√µes - Time da Casa",
  "Away Team Total Cards": "Total de Cart√µes - Time Visitante",
  "Total ShotOnGoal": "Total de Finaliza√ß√µes no Gol",
  "Away Team Total Goals(2nd Half)": "Total de Gols - Time Visitante (2¬∫ Tempo)",
  "Draw No Bet (1st Half)": "Empate Anula Aposta (1¬∫ Tempo)",
  "Draw No Bet (2nd Half)": "Empate Anula Aposta (2¬∫ Tempo)",
  "Home team will score in both halves": "Time da Casa Marcar√° em Ambos os Tempos",
  "Away team will score in both halves": "Time Visitante Marcar√° em Ambos os Tempos",
  "Corners Asian Handicap": "Handicap Asi√°tico de Escanteios",
  "Home Corners Over/Under": "Escanteios do Time da Casa Acima/Abaixo",
  "Away Corners Over/Under": "Escanteios do Time Visitante Acima/Abaixo",
  "Own Goal": "Gol Contra",
  "Home Team Total Goals(2nd Half)": "Total de Gols - Time da Casa (2¬∫ Tempo)"





    };
    return traducoes[nomeOriginal] || nomeOriginal;
}


async function carregarOddsReais() {
    const ligaID = document.getElementById("liga").value;
    const filtroTime = document.getElementById("filtroTime").value.trim().toLowerCase();
    const headers = {
        "x-apisports-key": API_KEY,
        "Accept": "application/json"
    };

    const dataInput = document.getElementById("dataFiltro").value;
    const dataSelecionada = dataInput ? dataInput : new Date().toISOString().split("T")[0];

    const oddMin = parseFloat(document.getElementById("oddMin").value) || 0;
    const oddMax = parseFloat(document.getElementById("oddMax").value) || Infinity;

    const inputs = document.getElementById("inputs");
    const existentes = new Set(Array.from(inputs.querySelectorAll(".jogo-card")).map(card => card.dataset.id));

    let todosFixtures = [];

    try {
        const temporadas = [2024, 2025];
        for (const temporada of temporadas) {
            const url = `https://v3.football.api-sports.io/fixtures?league=${ligaID}&season=${temporada}&date=${dataSelecionada}`;
            const response = await fetch(url, { headers });
            const data = await response.json();
            if (!data.response || !Array.isArray(data.response)) continue;
            todosFixtures = todosFixtures.concat(data.response);
        }

        for (const fixture of todosFixtures) {
            const fixtureId = fixture.fixture.id;
            if (existentes.has(String(fixtureId))) continue;

            const dataHora = new Date(fixture.fixture.date);
            const homeTeam = fixture.teams.home.name;
            const awayTeam = fixture.teams.away.name;

            if (filtroTime &&
                !homeTeam.toLowerCase().includes(filtroTime) &&
                !awayTeam.toLowerCase().includes(filtroTime)) {
                continue;
            }

            const oddsResp = await fetch(`https://v3.football.api-sports.io/odds?fixture=${fixtureId}`, { headers });
            const oddsJson = await oddsResp.json();
            const oddsData = oddsJson.response[0];
            if (!oddsData || !oddsData.bookmakers?.length) continue;

            
const betano = oddsData.bookmakers.find(b => b.name.toLowerCase().includes("betano"));
if (!betano) return;
const bets = betano.bets;

            const dataStr = dataHora.toLocaleDateString("pt-BR", { day: '2-digit', month: 'short' });
            const horaStr = dataHora.toLocaleTimeString("pt-BR", { hour: '2-digit', minute: '2-digit' });

            const mercadoPrincipal = bets.find(bet => bet.name === "Match Winner");
            const outrosMercados = bets.filter(bet => bet.name !== "Match Winner");

            let mercadoPrincipalHTML = '';
            if (mercadoPrincipal) {
                mercadoPrincipal.values.forEach(odd => {
                    const oddValor = parseFloat(odd.odd);
                    if (oddValor < oddMin || oddValor > oddMax) return;
                    const nomeTraduzido = traduzirValorOdd(odd.value);
                    const timeRelacionado = nomeTraduzido === 'Casa' ? homeTeam :
                                            nomeTraduzido === 'Fora' ? awayTeam :
                                            `${homeTeam} x ${awayTeam}`;
                    mercadoPrincipalHTML += `<label>
                    <input type="checkbox" class="jogoCheck" data-nome="${nomeTraduzido}" data-odd="${parseFloat(odd.odd).toFixed(2)}" data-jogo="${timeRelacionado}" />
                    ${nomeTraduzido} - ${parseFloat(odd.odd).toFixed(2)}
                    </label>`;
                });
            }

            let maisOddsHTML = '';
            outrosMercados.forEach((bet, index) => {
                const nomeMercado = traduzirMercado(bet.name);
                const mercadoId = `mercado-${fixtureId}-${index}`;

                let oddsHTML = '';
                bet.values.forEach(odd => {
                    const oddValor = parseFloat(odd.odd);
                    if (oddValor < oddMin || oddValor > oddMax) return;
                    const valorTraduzido = traduzirValorOdd(odd.value);
                    const timeRelacionado = ['Casa', 'Home'].includes(valorTraduzido) ? homeTeam :
                                            ['Fora', 'Away'].includes(valorTraduzido) ? awayTeam :
                                            `${homeTeam} x ${awayTeam}`;
                    oddsHTML += `<label>
                        <input type="checkbox" class="jogoCheck" data-nome="${nomeMercado}: ${valorTraduzido}" data-odd="${parseFloat(odd.odd).toFixed(2)}" data-jogo="${timeRelacionado}" />
                        ${valorTraduzido} - ${parseFloat(odd.odd).toFixed(2)}
                    </label>`;
                });

                maisOddsHTML += `
                    <div style="margin-bottom: 10px;">
                        <button class="btn-toggle-mercado" onclick="document.getElementById('${mercadoId}').style.display = (document.getElementById('${mercadoId}').style.display === 'block' ? 'none' : 'block')">‚ûï ${nomeMercado}</button>
                        <div class="collapse mercado-odds" id="${mercadoId}" style="display:none;margin-top:5px;padding-left:10px;">
                            ${oddsHTML || "<p>Sem odds dispon√≠veis</p>"}
                        </div>
                    </div>
                `;
            });

            const collapseId = `collapse-${fixtureId}`;
            const logoHome = fixture.teams.home.logo;
            const logoAway = fixture.teams.away.logo;
            const logoLiga = fixture.league.logo;
            const nomeLiga = fixture.league.name;

            inputs.innerHTML += `
                <div class="jogo-card" data-id="${fixtureId}">
                <div class="jogo-header">
                    <img src="${logoLiga}" alt="Liga" style="height:20px;margin-right:8px;vertical-align:middle;">
                    ${nomeLiga}
                </div>
                <div class="jogo-conteudo">
                    <div class="jogo-info">üóìÔ∏è ${dataStr} √†s ${horaStr}</div>
                    <div class="jogo-times">
                    <img src="${logoHome}" alt="${homeTeam}"> <strong>${homeTeam}</strong>
                    <span>vs</span>
                    <img src="${logoAway}" alt="${awayTeam}"> <strong>${awayTeam}</strong>
                    </div>
                    <div class="mercado-principal"><strong>Resultado Final</strong>${mercadoPrincipalHTML || "<p>Sem odds dispon√≠veis</p>"}</div>
                    <button class="btn-mais-odds" type="button" onclick="document.getElementById('${collapseId}').classList.toggle('show')">Ver Mais Odds</button>
                    <div class="collapse mais-odds" id="${collapseId}" style="display:none;">
                        <div class="card card-body">${maisOddsHTML || "<p>Sem mais odds dispon√≠veis</p>"}</div>
                    </div>
                </div>
                </div>
            `;
        }
    } catch (error) {
        console.error('Erro:', error);
        alert('Erro ao carregar dados. Verifique o console.');
    }
}


document.addEventListener('click', function(e){
    if (e.target && e.target.classList.contains('btn-mais-odds')) {
        const target = e.target.nextElementSibling;
        if (target.style.display === 'block') {
            target.style.display = 'none';
            e.target.innerText = 'Ver Mais Odds';
        } else {
            target.style.display = 'block';
            e.target.innerText = 'Ver Menos Odds';
        }
    }
});

function gerarCombinacoes(array, k) {
    let res = [];
    function comb(start, combo) {
        if (combo.length === k) return res.push(combo);
        for (let i = start; i < array.length; i++) {
            comb(i + 1, combo.concat([array[i]]));
        }
    }
    comb(0, []);
    return res;
}

function gerarDesdobramento() {
    const tipoDesdobramento = parseInt(document.getElementById("tipoDesdobramento").value);
    const stake = parseFloat(document.getElementById("stake").value);
    const checkboxes = document.querySelectorAll(".jogoCheck:checked");

    if (checkboxes.length < tipoDesdobramento) {
        alert(`Voc√™ selecionou apenas ${checkboxes.length} jogos, mas escolheu um desdobramento de ${tipoDesdobramento}.`);
        return;
    }

    if (isNaN(stake) || stake <= 0) {
        alert("Insira um valor v√°lido para a aposta.");
        return;
    }

    const jogos = Array.from(checkboxes).map(cb => ({
        jogo: cb.dataset.nome,
        odd: parseFloat(cb.dataset.odd),
        partida: cb.dataset.jogo
    }));

    const combinacoes = gerarCombinacoes(jogos, tipoDesdobramento);
    let html = `<h3>Combina√ß√µes ${tipoDesdobramento}</h3>`;
    let totalRetorno = 0;

    combinacoes.forEach((combo, i) => {
        const oddTotal = combo.reduce((acc, cur) => acc * cur.odd, 1);
        const retorno = stake * oddTotal;
        totalRetorno += retorno;
        const selecoes = combo.map(j => `- ${j.jogo} (${j.partida})`).join("<br>");
        html += `<div style="background:#fff;border-radius:10px;padding:12px;margin-bottom:15px;box-shadow:0 2px 8px rgba(0,0,0,0.1);color:#000;">
        <div style="color:#ff7f00;font-weight:bold;font-size:1rem;">üéüÔ∏è Bilhete ${i + 1} - Odd Total: ${oddTotal.toFixed(2)}</div>
        <div style="margin:6px 0 8px 0;font-size:0.95rem;line-height:1.4;">${selecoes}</div>
        <div style="color:green;font-weight:bold;font-size:0.95rem;">üí∞ Retorno: R$ ${retorno.toFixed(2)}</div>
        </div>`;
    });

    const totalApostado = (combinacoes.length * stake).toFixed(2);
    html += `<p><strong>üì¶ Total de combina√ß√µes:</strong> ${combinacoes.length}</p><p><strong>üí∏ Total Apostado:</strong> R$ ${totalApostado}</p><p style="color:green;"><strong>üîÆ Retorno m√°ximo se acertar todos:</strong> R$ ${totalRetorno.toFixed(2)}</p>`;
    document.getElementById("resultado").innerHTML = html;
}

function exportarPDF() {
    const resultado = document.getElementById("resultado");
    if (!resultado.innerHTML.trim()) {
        alert("Gere os bilhetes antes de exportar.");
        return;
    }
    const janela = window.open('', '', 'width=800,height=600');
    janela.document.write(`<html><head><title>Bilhetes - L.A Cashback VIP üëë</title></head><body>

<div id="bilhete" class="bilhete-lateral">
  <h3>üéØ Desdobramento</h3>
  <div id="bilhete-selecoes"></div>
  <label>Acertos desejados:</label>
  <select id="acertos-desejados"></select>
  <label>Valor por combina√ß√£o (R$):</label>
  <input type="number" id="valor-aposta" placeholder="10.00" step="0.01" oninput="atualizarRetorno()">
  <div id="resultado-desdobramento"></div>
  <button onclick="limparSelecoes()">üßπ Limpar</button>
  <button onclick="exportarPDF()">üìÑ PDF</button>
  <button onclick="compartilharWhatsApp()">üì§ WhatsApp</button>
</div>
<button id="botao-bilhete" onclick="toggleBilhete()">üéØ</button>


<audio id="bgMusic" loop>
  <source src="musica.mp3" type="audio/mpeg">
  Seu navegador n√£o suporta √°udio.
</audio>

<button onclick="document.getElementById('bgMusic').play()" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #ff7f00;
  color: white;
  border: none;
  border-radius: 50%;
  width: 60px;
  height: 60px;
  font-size: 20px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  z-index: 999;
">üîä</button>
<h2>Bilhetes - L.A Cashback VIP üëë</h2>${resultado.innerHTML}</body></html>`);
    janela.document.close();
    janela.print();
}

function compartilharWhatsApp() {
    const resultado = document.getElementById("resultado");
    if (!resultado.innerHTML.trim()) {
        alert("Gere os bilhetes antes de compartilhar.");
        return;
    }
    const tempDiv = document.createElement("div");
    tempDiv.innerHTML = resultado.innerHTML;
    let texto = tempDiv.innerText;
    texto = "üî• *L.A Cashback VIP üëë* üî•\n\n" + texto.trim();
    texto = texto.replace(/Bilhete (\d+)/g, "üéüÔ∏è Bilhete $1");
    texto = texto.replace(/Retorno: R\$/, "üí∞ Retorno: R$");
    texto = texto.replace(/Total Apostado:/, "üí∏ Total Apostado:");
    texto = texto.replace(/Total de combina√ß√µes:/, "üì¶ Total de combina√ß√µes:");
    texto = texto.replace(/Retorno m√°ximo se acertar todos:/, "üîÆ Retorno m√°ximo:");
    texto += "\n\nü§ù Powered by L.A Cashback VIP üëë";
    const url = `https://wa.me/?text=${encodeURIComponent(texto)}`;
    window.open(url, "_blank");
}

function atualizarBilhete() {
    const checks = document.querySelectorAll('.jogoCheck:checked');
    const bilheteDiv = document.getElementById('bilhete-selecoes');
    const acertosSelect = document.getElementById('acertos-desejados');
    bilheteDiv.innerHTML = '';
    acertosSelect.innerHTML = '';

    if (checks.length === 0) {
        acertosSelect.innerHTML = '<option disabled selected>Sem sele√ß√µes</option>';
        document.getElementById("resultado-desdobramento").innerHTML = '<p>Selecione odds para gerar o desdobramento.</p>';
        return;
    }

    checks.forEach(cb => {
        const nome = cb.dataset.nome;
        const jogo = cb.dataset.jogo;
        const item = document.createElement('div');
        item.style.marginBottom = '6px';
        item.innerHTML = `‚úÖ <strong>${nome}</strong> (${jogo})`;
        bilheteDiv.appendChild(item);
    });

    const maxAcertos = Math.min(20, checks.length);
  for (let i = 1; i <= checks.length; i++) {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `Acertar ${i}`;
        acertosSelect.appendChild(opt);
    }

    gerarDesdobramentoNoBilhete();
}

function gerarCombinacoes(array, k) {
    let res = [];
    function comb(start, combo) {
        if (combo.length === k) return res.push(combo);
        for (let i = start; i < array.length; i++) {
            comb(i + 1, combo.concat([array[i]]));
        }
    }
    comb(0, []);
    return res;
}

function gerarDesdobramentoNoBilhete() {
    const tipoDesdobramento = parseInt(document.getElementById("acertos-desejados").value);
    const stake = parseFloat(document.getElementById("valor-aposta").value);
    const checks = document.querySelectorAll(".jogoCheck:checked");

    const resultadoDiv = document.getElementById("resultado-desdobramento");
    if (checks.length < tipoDesdobramento) {
        resultadoDiv.innerHTML = '<p>Selecione mais jogos para esse desdobramento.</p>';
        return;
    }

    const jogos = Array.from(checks).map(cb => ({
        jogo: cb.dataset.nome,
        odd: parseFloat(cb.dataset.odd),
        partida: cb.dataset.jogo
    }));

    const combinacoes = gerarCombinacoes(jogos, tipoDesdobramento);
    let html = '';
    let totalRetorno = 0;

    combinacoes.forEach((combo, i) => {
        const oddTotal = combo.reduce((acc, cur) => acc * cur.odd, 1);
        const retorno = (stake || 0) * oddTotal;
        totalRetorno += retorno;
        const selecoes = combo.map(j => `- ${j.jogo} (${j.partida})`).join("<br>");
        html += `<div style="background:#fff;border-radius:10px;padding:8px;margin-bottom:8px;color:#000;">
        <div style="color:#ff7f00;font-weight:bold;">üéüÔ∏è Bilhete ${i + 1} - Odd: ${oddTotal.toFixed(2)}</div>
        <div style="margin:6px 0;">${selecoes}</div>
        <div style="color:green;">üí∞ Retorno: R$ ${retorno.toFixed(2)}</div>
        </div>`;
    });

    const totalApostado = (combinacoes.length * (stake || 0)).toFixed(2);
    html += `<p><strong>üì¶ Total de bilhetes:</strong> ${combinacoes.length}</p>
             <p><strong>üí∏ Total Apostado:</strong> R$ ${totalApostado}</p>
             <p style="color:green;"><strong>üîÆ Retorno m√°ximo:</strong> R$ ${totalRetorno.toFixed(2)}</p>`;
    resultadoDiv.innerHTML = html;
}

document.addEventListener('change', function(e) {
    if (e.target && e.target.classList.contains('jogoCheck')) {
        atualizarBilhete();
    }
});

function atualizarRetorno() {
    gerarDesdobramentoNoBilhete();
}

function toggleBilhete() {
    const bilhete = document.getElementById('bilhete');
    bilhete.style.display = (bilhete.style.display === 'block') ? 'none' : 'block';
}



async function carregarJogosAoVivo() {
    const headers = {
        "x-apisports-key": API_KEY,
        "Accept": "application/json"
    };

    const inputs = document.getElementById("inputs");
    inputs.innerHTML = "";
    const existentes = new Set();

    try {
        const url = "https://v3.football.api-sports.io/fixtures?live=all";
        const response = await fetch(url, { headers });
        const data = await response.json();
        const jogos = data.response;

        if (!jogos.length) {
            inputs.innerHTML = "<p style='color:#ff7f00;'>‚ö†Ô∏è Nenhum jogo ao vivo no momento.</p>";
            return;
        }

        for (const fixture of jogos) {
            const fixtureId = fixture.fixture.id;
            if (existentes.has(String(fixtureId))) continue;

            const homeTeam = fixture.teams.home.name;
            const awayTeam = fixture.teams.away.name;
            const tempo = fixture.fixture.status.elapsed || "0";
            const logoHome = fixture.teams.home.logo;
            const logoAway = fixture.teams.away.logo;
            const logoLiga = fixture.league.logo;
            const nomeLiga = fixture.league.name;
            const score = fixture.goals;

            let corHome = 'white', corAway = 'white';
            if (score.home > score.away) {
                corHome = 'limegreen'; corAway = 'crimson';
            } else if (score.home < score.away) {
                corHome = 'crimson'; corAway = 'limegreen';
            } else {
                corHome = corAway = 'gold';
            }

            const oddsResp = await fetch(`https://v3.football.api-sports.io/odds?fixture=${fixtureId}`, { headers });
            const oddsJson = await oddsResp.json();
            const oddsData = oddsJson.response[0];
            if (!oddsData || !oddsData.bookmakers?.length) continue;

            const betano = oddsData.bookmakers.find(b => b.name.toLowerCase().includes("betano"));
            if (!betano) continue;
            const bets = betano.bets;

            const mercadoPrincipal = bets.find(bet => bet.name === "Match Winner");
            const outrosMercados = bets.filter(bet => bet.name !== "Match Winner");

            // Estat√≠sticas adicionais
            let posseCasa = 0, posseFora = 0, chutesCasa = 0, chutesFora = 0, escanteiosCasa = 0, escanteiosFora = 0;
            try {
                const statsResp = await fetch(`https://v3.football.api-sports.io/fixtures/statistics?fixture=${fixtureId}`, { headers });
                const statsJson = await statsResp.json();
                const estatisticas = statsJson.response;

                estatisticas.forEach(teamStat => {
                    const timeNome = teamStat.team.name;
                    teamStat.statistics.forEach(stat => {
                        if (stat.type === "Ball Possession") {
                            const valor = parseInt(stat.value);
                            if (timeNome === homeTeam) posseCasa = valor;
                            if (timeNome === awayTeam) posseFora = valor;
                        }
                        if (stat.type === "Total Shots") {
                            const valor = parseInt(stat.value);
                            if (timeNome === homeTeam) chutesCasa = valor;
                            if (timeNome === awayTeam) chutesFora = valor;
                        }
                        if (stat.type === "Corner Kicks") {
                            const valor = parseInt(stat.value);
                            if (timeNome === homeTeam) escanteiosCasa = valor;
                            if (timeNome === awayTeam) escanteiosFora = valor;
                        }
                    });
                });
            } catch (e) {
                console.warn("Estat√≠sticas n√£o dispon√≠veis para o jogo:", fixtureId);
            }

            let alertas = [];
            for (const bet of outrosMercados.concat(mercadoPrincipal || [])) {
                const nomeMercado = bet.name.toLowerCase();
                for (const odd of bet.values) {
                    const oddValor = parseFloat(odd.odd);
                    const oddDescricao = traduzirValorOdd(odd.value);

                    if (nomeMercado.includes("goals over/under") && odd.value === "Over 1.5") {
                        alertas.push(`‚öΩ Acima de 1.5 gols dispon√≠vel (Odd ${oddValor.toFixed(2)})`);
                    }
                    if (nomeMercado.includes("corners") && odd.value.includes("Over 5.5")) {
                        alertas.push(`üö© Escanteios Over 5.5`);
                    }
                    if (bet.name === "Match Winner") {
                        if (odd.value === "Home" && oddValor < 1.80) {
                            alertas.push(`üî• Casa favorita (Odd ${oddValor.toFixed(2)})`);
                        }
                        if (odd.value === "Away" && oddValor < 1.80) {
                            alertas.push(`üî• Visitante favorito (Odd ${oddValor.toFixed(2)})`);
                        }
                        if (oddValor >= 2.00 && ["Home", "Away"].includes(odd.value)) {
                            alertas.push(`üéØ Odd interessante para ${traduzirValorOdd(odd.value)} (Odd ${oddValor.toFixed(2)})`);
                        }
                    }
                }
            }

            // Alertas baseados em estat√≠sticas
            if (posseCasa >= 60 && chutesCasa >= 5) {
                alertas.push(`üìä Casa pressionando (${posseCasa}% posse, ${chutesCasa} chutes)`);
            }
            if (escanteiosCasa >= 5 && tempo < 45) {
                alertas.push(`üö© Casa tem ${escanteiosCasa} escanteios no 1¬∫ tempo`);
            }
            if (posseFora >= 60 && chutesFora >= 5) {
                alertas.push(`üìä Visitante pressionando (${posseFora}% posse, ${chutesFora} chutes)`);
            }
            if (escanteiosFora >= 5 && tempo < 45) {
                alertas.push(`üö© Visitante tem ${escanteiosFora} escanteios no 1¬∫ tempo`);
            }

            let alertaTips = '';
            if (alertas.length) {
                alertaTips = `<div style="color:yellow;font-weight:bold;margin:10px 0;background:#333;padding:6px 10px;border-radius:8px;box-shadow:0 0 10px rgba(255,255,0,0.5);">
                ‚ö†Ô∏è Alertas:<br>${alertas.join('<br>')}
                </div>`;
            }

            let mercadoPrincipalHTML = '';
            if (mercadoPrincipal) {
                mercadoPrincipal.values.forEach(odd => {
                    const nomeTraduzido = traduzirValorOdd(odd.value);
                    const timeRelacionado = nomeTraduzido === 'Casa' ? homeTeam :
                                            nomeTraduzido === 'Fora' ? awayTeam :
                                            `${homeTeam} x ${awayTeam}`;
                    mercadoPrincipalHTML += `<label>
                        <input type="checkbox" class="jogoCheck" data-nome="${nomeTraduzido}" data-odd="${parseFloat(odd.odd).toFixed(2)}" data-jogo="${timeRelacionado}" />
                        ${nomeTraduzido} - ${parseFloat(odd.odd).toFixed(2)}
                    </label>`;
                });
            }

            let maisOddsHTML = '';
            outrosMercados.forEach((bet, index) => {
                const nomeMercado = traduzirMercado(bet.name);
                const mercadoId = `mercado-live-${fixtureId}-${index}`;

                let oddsHTML = '';
                bet.values.forEach(odd => {
                    const valorTraduzido = traduzirValorOdd(odd.value);
                    const timeRelacionado = ['Casa', 'Home'].includes(valorTraduzido) ? homeTeam :
                                            ['Fora', 'Away'].includes(valorTraduzido) ? awayTeam :
                                            `${homeTeam} x ${awayTeam}`;
                    oddsHTML += `<label>
                        <input type="checkbox" class="jogoCheck" data-nome="${nomeMercado}: ${valorTraduzido}" data-odd="${parseFloat(odd.odd).toFixed(2)}" data-jogo="${timeRelacionado}" />
                        ${valorTraduzido} - ${parseFloat(odd.odd).toFixed(2)}
                    </label>`;
                });

                maisOddsHTML += `
                    <div style="margin-bottom: 10px;">
                        <button class="btn-toggle-mercado" onclick="document.getElementById('${mercadoId}').style.display = (document.getElementById('${mercadoId}').style.display === 'block' ? 'none' : 'block')">‚ûï ${nomeMercado}</button>
                        <div class="collapse mercado-odds" id="${mercadoId}" style="display:none;margin-top:5px;padding-left:10px;">
                            ${oddsHTML || "<p>Sem odds dispon√≠veis</p>"}
                        </div>
                    </div>
                `;
            });

            const collapseId = `collapse-live-${fixtureId}`;

            inputs.innerHTML += `
                <div class="jogo-card" data-id="${fixtureId}">
                    <div class="jogo-header">
                        <img src="${logoLiga}" alt="Liga" style="height:20px;margin-right:8px;vertical-align:middle;">
                        ${nomeLiga} - ‚è±Ô∏è ${tempo}' ao vivo
                    </div>
                    <div class="jogo-times" style="gap: 10px;">
                        <img src="${logoHome}" alt="${homeTeam}">
                        <strong style="color:${corHome}">${homeTeam}</strong>
                        <span style="font-size: 1.2rem; font-weight: bold;">[${score.home} - ${score.away}]</span>
                        <strong style="color:${corAway}">${awayTeam}</strong>
                        <img src="${logoAway}" alt="${awayTeam}">
                    </div>
                    ${alertaTips}
                    <div class="mercado-principal"><strong>Resultado Final</strong>${mercadoPrincipalHTML}</div>
                    <button class="btn-mais-odds" type="button" onclick="document.getElementById('${collapseId}').classList.toggle('show')">Ver Mais Odds</button>
                    <div class="collapse mais-odds" id="${collapseId}" style="display:none;">
                        <div class="card card-body">${maisOddsHTML || "<p>Sem mais odds dispon√≠veis</p>"}</div>
                    </div>
                </div>
            `;
        }
    } catch (error) {
        console.error("Erro ao buscar jogos ao vivo:", error);
        inputs.innerHTML = "<p style='color:red;'>‚ùå Erro ao buscar jogos ao vivo.</p>";
    }
}

let atualizacaoAoVivoAtiva = false;
function iniciarAutoAtualizacaoAoVivo() {
    if (atualizacaoAoVivoAtiva) return;
    atualizacaoAoVivoAtiva = true;
    setInterval(() => {
        if (document.hasFocus()) {
            carregarJogosAoVivo();
        }
    }, 30000);
}

</script>
</body>
</html>
